# ユーザー画面仕様書

## 1. 目的
- 管理者・運用担当が、システムに登録されたユーザーの情報を一覧・管理できる画面の機能要件を定義する。
- ユーザー情報の登録・更新・削除を安全かつ効率的に行える操作体験を提供する。

## 2. 利用者と目標
- **利用者**: システム管理者、チームリーダー、サポート担当。
- **主なニーズ**
  - 登録済みユーザーの状態を迅速に把握する。
  - 新規メンバーを登録し、権限やステータスを設定する。
  - 既存ユーザーの属性や権限を見直す。
  - 退職者・無効ユーザーを削除し、情報を整理する。

## 3. 機能概要
- ユーザー一覧表示
  - 氏名・メールアドレス・権限・ステータスを表形式で提示。
  - 一覧は視認性を高めるため、氏名順に配置する。
- 絞り込み／整列
  - 初期は全ユーザーを表示。フィルタや検索は将来的な拡張項目とする。
- ユーザー登録
  - 追加ボタンからモーダル/サブ画面を開き、必要情報を入力して登録。
  - 登録完了後、一覧へ新しいユーザーが即時反映される。
- ユーザー編集
  - 一覧から対象ユーザーを選択し、権限・ステータス・氏名・プロフィール画像などの属性を更新。
  - 更新結果は一覧に反映される。
- ユーザー削除
  - 削除操作には確認を求め、同意後に一覧からユーザーを除去する。
  - 削除後は関連情報が整理された状態で一覧が再表示される。
- リフレッシュ
  - 一覧を再取得するための更新操作を提供し、他者の変更を取り込めるようにする。
- 状態表示
  - 読み込み中・エラー・データなし等の状況を画面上で明示する。

## 4. 画面構成（機能レベル）
- **ページヘッダー**
  - 本画面のタイトルと簡単な説明文を表示し、コンテキストを示す。
- **操作エリア**
  - ユーザー追加ボタン、更新ボタンなどの主要アクションをまとめて配置。
- **ユーザー一覧領域**
  - 表形式でユーザーを表示し、行ごとに編集・削除アクションを提供。
- **モーダル／ダイアログ**
  - ユーザー追加と編集に使用。必要項目の入力フィールド、保存・キャンセル操作を備える。
  - 入力項目は縦一列に単項目で配置し、フォームヘッダー（タイトル）とフッターの操作ボタン（保存／キャンセル）は常に固定表示される。スクロールは入力領域のみが動く。
- **フィードバック領域**
  - エラー、空状態、処理中インジケーター等を表示して利用者に状態を通知する。

## 5. ユースケース
1. **登録されたユーザーを確認する**
   - 画面を開くと自動的に最新のユーザー一覧が読み込まれ、権限やステータスを把握できる。
2. **新しいユーザーを追加する**
   - 追加ボタンから必要情報（氏名、メール、権限、ステータス、任意の画像 URL）を入力し、保存するとユーザーが新規登録される。
3. **既存ユーザーの情報を更新する**
   - 対象ユーザーの編集操作を選択し、権限やステータス、氏名、画像などを変更して保存する。
4. **不要なユーザーを削除する**
   - 削除操作を選択すると確認メッセージが表示され、承諾すると一覧からユーザーが消去される。
5. **情報を最新状態に更新する**
   - 更新ボタンを押すことで一覧がサーバーの最新状態と同期される。

## 6. 入力項目と制約
- **氏名**: 必須。1 文字以上。
- **メールアドレス**: 必須。メール形式で入力。
- **権限**: 必須。定義済みの権限種別から選択（例: 管理者、マネージャー、一般ユーザー）。
- **ステータス**: 必須。ユーザーの状態種別から選択（例: 有効、招待中、無効）。
- **プロフィール画像 URL**: 任意。URL 形式の文字列。入力しない場合は画像なしとして扱う。

## 7. メッセージとフィードバック
- 入力不足や不正値がある場合は、送信前に利用者へ警告する。
- サーバー側で検出したエラー（重複メール、対象ユーザーなし等）はそのメッセージを画面上で表示する。
- 幅広い操作に対し、処理中のインジケーターや完了後の結果を即時反映し、利用者が状況を把握できるようにする。
- フロントエンドでは react-hook-form と Zod によるバリデーションを実装し、各フィールド直下にエラーメッセージを表示する。

## 8. 非機能要件（画面単位）
- 操作レスポンス: 一覧更新や CRUD 操作は数秒以内に結果を返す。
- ユーザビリティ: 主要アクションは常に視認しやすい場所に配置し、操作導線を明確にする。
- アクセシビリティ: 入力フィールドやボタンに明確なラベルとフォーカス移動があり、キーボードでも操作できる。

## 9. 今後の拡張（参考）
- ユーザー検索やフィルタリング機能。
- CSV などへのエクスポート。
- バルク操作（複数ユーザーの一括管理）。

## 10. ユーザー項目一覧（定義）

| No. | 項目名 (UI ラベル) | フィールドキー案 | 種別 | 必須 | 入力仕様／制約 | 表示箇所 | 備考 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | ユーザー ID | `id` | 文字列 | 自動 | UUID | 一覧／詳細 | 編集不可 |
| 2 | 氏名 | `name` | 文字列 | 必須 | 1〜100 文字 | 一覧／詳細 | 画面上の表示名 |
| 3 | 氏名（カナ） | `nameKana` | 文字列 | 任意 | 全角カナ 1〜100 文字 | 詳細 | 検索・音声案内用 |
| 4 | メールアドレス | `email` | 文字列 | 必須 | メール形式、一意制約 | 一覧／詳細 | 認証・通知で使用 |
| 5 | 権限 | `role` | 列挙型 | 必須 | `ADMIN`, `MANAGER`, `USER` 等 | 一覧／詳細 | 追加ロールが必要な場合は拡張 |
| 6 | ステータス | `status` | 列挙型 | 必須 | `ACTIVE`, `INVITED`, `DISABLED` 等 | 一覧／詳細 | 有効/招待中/停止 など |
| 7 | プロフィール画像 URL | `image` | 文字列 | 任意 | URL 形式 | 詳細 | 空欄の場合は画像なし |
| 8 | 電話番号 | `phoneNumber` | 文字列 | 任意 | 電話番号形式 | 詳細 | 将来の通知設定向け |
| 9 | 所属部署 | `department` | 文字列 | 任意 | 最大 100 文字 | 詳細 | 組織構造に応じて表示 |
| 10 | 職位／役割 | `title` | 文字列 | 任意 | 最大 100 文字 | 詳細 | 表示/通知用 |
| 11 | 最終ログイン日時 | `lastLoginAt` | 日時 | 自動 | ISO8601 | 詳細 | 監査用途 |
| 12 | MFA 有効化状況 | `mfaEnabled` | 真偽値 | 自動 | 内部制御 | 詳細 | セキュリティ要件に応じて表示 |
| 13 | ロック状態 | `isLocked` | 真偽値 | 自動 | 内部制御 | 詳細 | アカウントロック確認 |
| 14 | 作成日時 | `createdAt` | 日時 | 自動 | ISO8601 | 詳細 | 編集不可 |
| 15 | 更新日時 | `updatedAt` | 日時 | 自動 | ISO8601 | 一覧／詳細 | 編集不可 |
| 16 | 作成者 | `createdBy` | 文字列 | 自動 | ユーザー ID | 詳細 | 監査用 |
| 17 | 更新者 | `updatedBy` | 文字列 | 自動 | ユーザー ID | 詳細 | 監査用 |
| 18 | 備考 | `note` | 文字列 | 任意 | 最大 500 文字 | 詳細 | 特記事項 |

> 上記は画面・API 設計時の参考項目であり、実装段階で利用シーンに合わせて精査する。特に監査項目やセキュリティ関連項目は要件定義の結果に応じて表示可否を決定する。
